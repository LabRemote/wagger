"use strict";class Disp{constructor(){this.data=[]}static rGBAArrayFromLiteral(t){let i=[];-1!==t.search(/rgb/)&&(i=t.match(/([0-9]+\.?[0-9]*)/g)),3===i.length&&i.push(1);for(let t=0;t<i.length;t++)i[t]=parseInt(i[t],10);return i[3]*=255,i}static rGBALiteralFromArray(t){return"rgba("+t[0].toString()+","+t[1].toString()+","+t[2].toString()+","+(t[3]/255).toString()+")"}static setProperties(t,i){for(let e in i)t[e]=i[e]}static getProperty(t,i){return window.getComputedStyle(t,null).getPropertyValue(i)}static addFonts(t,i){let e="";for(let s=0;s<t.length;s++){let l=t[s],a=l.split("."),n=a[a.length-1];"ttf"===n&&(n="truetype");let r=a[0],h=new FontFace(r,"url(."+i+l+") format('"+n+"')");h.load().then(function(){document.fonts.add(h)}).catch(t=>console.error(t.message)),e+="'"+r+"'",s<t.length-1&&(e+=", ")}return e}static getTagChannelIndex(t){let i=t.id.split("_"),e=null,s=null;return i.length>0&&(e=i[0],i.length>1&&(s=i[1])),[e,s]}static getChannelElement(t){let i=null,e=null;t.length>0&&(i=t[0],t.length>1&&(e=t[1]));let s=null,l=i;return null!==l&&(null!==e&&(l+="_"+e),s=document.getElementById(l)),s}static removeAllElements(t,i){for(let e=0,s=i.length;e!=s;++e){let s=t.getElementsByTagName(i[e]);for(let t=0,i=s.length;t!=i;++t)s[0].parentNode.removeChild(s[0])}}static htmlSpaces(t){let i="";for(let e=0;e<t;e++)i+="&nbsp;";return i}static getTimeLagText(t){let i="";return i=t>31536e3?parseInt(t/31536e3).toString()+" y":t>86400?parseInt(t/86400).toString()+" d":t>3600?parseInt(t/3600).toString()+" h":t>60?parseInt(t/60).toString()+" m":parseInt(t/1).toString()+" s"}setDisplayTextProperties(t,i,e,s,l,a){if(this.setAllTextAlpha(t,l),void 0!==this.data[t]){let l=this.data[t].screens[0],a="",n="";null!==i&&([a,n]=Disp.getTagChannelIndex(i));let r=l.time;if(null!==r){let t=Disp.getChannelElement(["timelabel",null]);t.innerHTML=r.str_val+r.padding,"timebkg"===a&&(t.innerHTML=r.str_val+r.info+(-e/1e6).toString().substring(0,7)+" s")}for(let i=0;i<l.channels.length;i++){let e=l.channels[i],a=e.index.toString();n===a&&this.setAllTextAlpha(t,255);let r=Disp.getChannelElement(["label",a]);r.innerHTML=e.str_val+e.padding,n===a&&(r.innerHTML=e.val.toString().substring(0,s)+" "+e.unit+e.info)}for(let t=0;t<l.img_channels.length;t++);for(let i=0;i<l.ctrl_channels.length;i++){let e=l.ctrl_channels[i],s=e.index.toString();n===s&&this.setAllTextAlpha(t,255);let a=Disp.getChannelElement(["setval",s]);if(a.innerHTML=e.str_val+e.padding,n===s){a.innerHTML=e.str_val+e.info,Disp.getChannelElement(["slider",s]).value=e.val}}}}setAllTextAlpha(t,i){if(void 0!==this.data[t]){let e=this.data[t].screens[0];for(let t=0;t<e.channels.length;t++){let s=e.channels[t].index.toString(),l=Disp.getChannelElement(["label",s]),a=Disp.getProperty(l,"color"),n=Disp.rGBAArrayFromLiteral(a);n[3]=i,l.style.color=Disp.rGBALiteralFromArray(n)}}}placeAndSizeTextElements(){}setControlElementStyle(){}}class App{constructor(){this.CANVAS={},this.CANVAS_POS_X=250,this.CANVAS_POS_Y=10,this.STD_SCALE_HEIGHT=480,this.DISPLAY_SELECT={},this.DISPLAY_INFO_TEXT={},this.DISPLAY_TIMEOUT_TEXT={},this.STANDARD_FONT_FAMILIES="'Arial', 'Verdana'",this.STANDARD_FONTSIZE=14,this.WARNING_FONTSIZE=36,this.TIMEOUT_FONTSIZE=14,this.MAX_DISPLAY_DIGITS=13,this.STANDARD_FOREGROUND_COLOR=[255,255,255,255],this.STANDARD_BACKGROUND_COLOR=[0,0,255,255],this.FRAME_RATE=5,this.REQUEST_INTERVAL=2,this.NTP_SYNC_INTERVAL=60,this.TIME_ZONE="UTC",this.BROWSER_URL=window.location.hostname,this.CLIENT_URL="http://"+this.BROWSER_URL+"/client/",this.FILES_DIR="images/",this.FILES_URL=this.CLIENT_URL+this.FILES_DIR,this.WAIT_MESSAGE="Retrieving data...",this.last_get=5,this.last_request=0,this.last_time_sync=0,this.display_index=0,this.display_timeout=900,this.display_viewport={},this.display_viewport.w=853,this.display_viewport.h=480,this.display_img_scale=1,this.display_kiosk_interval=0,this.display_kiosk_adjust={},this.display_kiosk_adjust.x=0,this.display_kiosk_adjust.y=0,this.display_kiosk_height=0,this.display_is_static=!1,this.display_image_loading=!1,this.display_timed_out=!1,this.display_override_font={},this.display_override_font.filename="",this.display_override_font.path="",this.all_font_families="",this.text_element_alpha=255,this.chan_index_string="",this.img_chan_index_string="",this.ctrl_chan_index_string="",this.img_url="",this.img={},this.test_img={},this.img_height=this.STD_SCALE_HEIGHT,this.img_width=4/3*this.img_height,this.start_time=-9999,this.end_time=-9999,this.time_bins=10,this.time_bin_size=1,this.data_time_string="",this.data_timestamp=0,this.server_time_string=this.WAIT_MESSAGE,this.server_timestamp=0,this.frames_active=0,this.saved_frames=0,this.ntp={},this.ntp.t1=0,this.ntp.t2=0,this.ntp.t3=0,this.ntp.t4=0,this.ntp.adjustment=0,this.ntp.timestamp=0,this.ntp.time_string=0,this.canvas_shift_x=0,this.canvas_shift_y=0,this.moved_slider=null,this.pressed_send=null,this.hovered_clicked_label=null}static arrayElementsIn(t){return!(!Array.isArray(t)||!t.length)}static isValidNumber(t){let i=parseFloat(t);return!isNaN(t)&&!isNaN(i)&&isFinite(i)}static isValidGT(t,i){return!(!App.isValidNumber(t)||!App.isValidNumber(i))&&parseFloat(t)>parseFloat(i)}static isValidDate(t){let i=!1;return"[object Date]"===Object.prototype.toString.call(t)&&(isNaN(t.getTime())||(i=!0)),i}static maxOfArray(t){return Math.max(...t.map(t=>Array.isArray(t)?maxOfArray(t):t))}static nthMaxOfArray(t,i){let e=App.maxOfArray(t);t.length-i<1&&(i+=t.length-i-1),i<0&&(i=0);for(let s=0;s<i;s+=1){let i=t.indexOf(e);i>-1&&t.splice(i,1),e=App.maxOfArray(t)}return e}static findWithAttr(t,i,e){for(let s=0;s<t.length;s+=1)if(t[s][i]===e)return s;return-1}setCanvasAutoScaleCenter(t,i){let e=t.length;if(e>0)for(let s=0;s<e;s++){let e=i[s].width,l=i[s].height,a=t[s];if("source"===a.dim&&e>1&&l>1){this.display_kiosk_height>0&&(a.disp.h=this.display_kiosk_height);let t=l/a.disp.h;this.display_img_scale=a.disp.h/this.STD_SCALE_HEIGHT,this.img_height=l/t,this.img_width=e/t}"center"===a.disp.pos&&(this.canvas_shift_x=Math.max(parseInt((this.display_viewport.w-this.img_width)/2),0),this.canvas_shift_y=Math.max(parseInt((this.display_viewport.h-this.img_height)/2),0))}}placeAndSizeCanvasElements(t,i,e,s){if(null!==t){let s=t.length;if(s>0)for(let l=0;l<s;l++){let s=t[l];if(null!==s){let t=s.disp;void 0===s.index&&(s.index=null);let l=Disp.getChannelElement([i,s.index]);null!==l&&Disp.setProperties(l.style,{fontSize:parseInt(t.size*this.display_img_scale/this.display_img_scale).toString()+"px",left:parseInt(t.pos.x*this.display_img_scale+this.CANVAS_POS_X+this.canvas_shift_x-t.size/2+e).toString()+"px",top:parseInt(t.pos.y*this.display_img_scale+this.CANVAS_POS_Y+this.canvas_shift_y-t.size+e).toString()+"px"})}}}}placeAndSizeCanvasText(t,i,e,s){Disp.setProperties(t.style,{fontSize:parseInt(i*A.display_img_scale/A.display_img_scale).toString()+"px",left:parseInt(A.CANVAS_POS_X+A.canvas_shift_x+Math.max(A.img_width/2-i*e+s,0)).toString()+"px",top:parseInt(A.CANVAS_POS_Y+A.canvas_shift_y+A.img_height/2-i/2).toString()+"px"})}}